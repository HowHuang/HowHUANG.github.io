<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Hao_HUANG">
    
    <title>
        
            parellel_computing_v1 |
        
        Haha
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo_me.jpeg">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/logo_me.jpeg","favicon":"/images/logo_me.jpeg","article_img_align":"center","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/first-screan_bg.png","description":null},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Haha
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">parellel_computing_v1</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/logo_me.jpeg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Hao_HUANG</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-04-24 14:46:31</span>
        <span class="mobile">2022-04-24 14:46</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/python/">python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>598 Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>3 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h4 id="parallelizing-a `for` loop with `pool()` and `map()`">Parallelizing a <code>for</code> loop with <code>pool()</code> and <code>map()</code></h4>
<p><code>for</code> loops are one of the most common things that we want to parallelize (<a class="link"   target="_blank" rel="noopener" href="https://zhu-group.github.io/ese5023/Section_10.html" >https://zhu-group.github.io/ese5023/Section_10.html<i class="fas fa-external-link-alt"></i></a>). To do that, I have known two kinds of “decorators”: <code>dask.delayed()</code> and <code>multiprocessing.pool()</code>.</p>
<h4 id="what-is `daskdelayed()`">What is <code>dask.delayed()</code></h4>
<p>You can see how it works and how to use it by reading this detailed tutorial (<a class="link"   target="_blank" rel="noopener" href="https://tutorial.dask.org/01_dask.delayed.html" >https://tutorial.dask.org/01_dask.delayed.html<i class="fas fa-external-link-alt"></i></a>). Briefly, using <code>dask.delayed</code> function to make the faster function not be called actually, delaying for other slower functions, using <code>.compute()</code> and <code>.visualize()</code> to get the final results and the task graph.</p>
<h4 id="what-is the differences between these two functions">What is the differences between these two functions</h4>
<p>Here is a thorough explanation (<a class="link"   target="_blank" rel="noopener" href="https://github.com/dask/dask/issues/1783" >https://github.com/dask/dask/issues/1783<i class="fas fa-external-link-alt"></i></a>). Briefly, <code>dask</code> ends up serializing the data for every argument, since they are all called separately, which is why it can eat up processing time. In contrast, <code>pool.map</code> splits the input data into batches, which can be more efficient than sending single elements (but not this much more efficient). This means you are still serializing the data to each worker process once under <code>multiprocessing</code>. So, the link suggested let <code>dask</code> do the data loading. Because when you do that, you’re not sending large chunks of data around, and also allows <code>dask</code> to minimize memory usage, as you’re not loading everything into memory at once.</p>
<h4 id="how-to use `pool()` and `map()`">How to use <code>pool()</code> and <code>map()</code></h4>
<p>Before using this method, you need to the differences between multiprocessing and multithreading, and decide to use which system to calculate. Briefly, there is benefit to using the multiprocessing system for CPU intensive processes and the multithreading system when many scripts related to network/data I/O spend the majority of their time waiting for data from a remote source ( <a class="link"   target="_blank" rel="noopener" href="https://chriskiehl.com/article/parallelism-in-one-line" >https://chriskiehl.com/article/parallelism-in-one-line<i class="fas fa-external-link-alt"></i></a>).</p>
<h5 id="besides,-what is `map()`? i think it is an another expression of functionnow, suppose that i have a function `calculation(parameter1)`">Besides, what is <code>map()</code>? I think it is an another expression of function.Now, suppose that I have a function <code>calculation(parameter1)</code></h5>
<h5 id="for-multiprocessing,">For multiprocessing,</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Pool</span><br><span class="line">parameter1 = list(range(0, 66)) ## keep the parameter1 as a list to input</span><br><span class="line">pool = Pool() ## if pool = Pool(4), 4 cpu processes will be used. if no number, all cpu will be called</span><br><span class="line">pool.map(calculation, parameter1) </span><br><span class="line"># Do not forget the following two functions to close the pool and wait for the work to finish</span><br><span class="line">pool.close() </span><br><span class="line">pool.join()</span><br></pre></td></tr></table></figure>
<h5 id="for-multithreading,">For multithreading,</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from multiprocessing import Pool</span><br><span class="line">from multiprocessing.dummy import Pool as ThreadPool</span><br><span class="line">parameter1 = list(range(0, 66)) ## keep the parameter1 as a list to input</span><br><span class="line">pool = ThreadPool() ## if pool = ThreadPool(4), 4 threads will be used. if no number, all threads will be called</span><br><span class="line">pool.map(calculation, parameter1) </span><br><span class="line"># Do not forget the following two functions to close the pool and wait for the work to finish</span><br><span class="line">pool.close() </span><br><span class="line">pool.join()</span><br></pre></td></tr></table></figure>
<h5 id="what-about more parameters?">What about more parameters?</h5>
<ol>
<li>Using <code>.map(calculation, parameter1, parameter2, ....) </code>, where you need to keep all parameters’ lists have same length.</li>
<li>Using  <code>list(itertools.product(parameter1, parameter2))</code> to create a list with two pair of parameters (<a class="link"   target="_blank" rel="noopener" href="https://docs.python.org/2/library/itertools.html#itertools.product" >https://docs.python.org/2/library/itertools.html#itertools.product<i class="fas fa-external-link-alt"></i></a>).</li>
<li>Using <code>new_calculation = partial(calculation, parameter1, parameter2 = 'A', parameter3 = 'B')</code> and <code>parameter1 = list(range(0, 66))</code> to get a new function that keep parameter1 change but the parameter2 = ‘A’ and parameter3 = ‘B’. Then<br>
<code>pool.map(calculation, parameter1)</code></li>
</ol>
<h4 id="what-are the meanings of `close()` and `.join()`">What are the meanings of <code>.close()</code> and <code>.join()</code></h4>
<p>pending to understand</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/budong282712018/article/details/79958592?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.pc_relevant_default&amp;utm_relevant_index=2" >https://blog.csdn.net/budong282712018/article/details/79958592?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&amp;utm_relevant_index=2<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/xiongzaiabc/article/details/81019605" >https://blog.csdn.net/xiongzaiabc/article/details/81019605<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/python/">#python</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/04/27/make-example/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">make_example</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/04/24/hexo-errors/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">hexo_errors</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;<i class="fa fa-hand-peace"></i>&nbsp;Hao_HUANG
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#parallelizing-a%20%60for%60%20loop%20with%20%60pool()%60%20and%20%60map()%60"><span class="nav-text">Parallelizing a for loop with pool() and map()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#what-is%20%60daskdelayed()%60"><span class="nav-text">What is dask.delayed()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#what-is%20the%20differences%20between%20these%20two%20functions"><span class="nav-text">What is the differences between these two functions</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#how-to%20use%20%60pool()%60%20and%20%60map()%60"><span class="nav-text">How to use pool() and map()</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#besides,-what%20is%20%60map()%60?%20i%20think%20it%20is%20an%20another%20expression%20of%20functionnow,%20suppose%20that%20i%20have%20a%20function%20%60calculation(parameter1)%60"><span class="nav-text">Besides, what is map()? I think it is an another expression of function.Now, suppose that I have a function calculation(parameter1)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#for-multiprocessing,"><span class="nav-text">For multiprocessing,</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#for-multithreading,"><span class="nav-text">For multithreading,</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#what-about%20more%20parameters?"><span class="nav-text">What about more parameters?</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#what-are%20the%20meanings%20of%20%60close()%60%20and%20%60.join()%60"><span class="nav-text">What are the meanings of .close() and .join()</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script>




<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>
</html>
